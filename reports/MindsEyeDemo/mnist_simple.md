Code from [MindsEyeDemo.scala:70](../../src/test/scala/MindsEyeDemo.scala#L70) executed in 0.56 seconds: 
```java
    var model: DAGNetwork = new DAGNetwork
    model = model.add(new DenseSynapseLayerJBLAS(Tensor.dim(inputSize:_*), outputSize).setWeights(new ToDoubleFunction[Coordinate] {
      override def applyAsDouble(value: Coordinate): Double = Util.R.get.nextGaussian * 0.0
    }))
    model = model.add(new BiasLayer(outputSize:_*))
    // model = model.add(new MinMaxFilterLayer());
    model = model.add(new SoftmaxActivationLayer)
    model
```

Returns: 

```
    {
  "class": "DAGNetwork",
  "id": "32bdbc21-af7b-447b-aa9f-63e500000001",
  "root": {
    "layer": {
      "class": "SoftmaxActivationLayer",
      "id": "32bdbc21-af7b-447b-aa9f-63e500000004"
    },
    "prev0": {
      "layer": {
        "class": "BiasLayer",
        "id": "32bdbc21-af7b-447b-aa9f-63e500000003",
        "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
      },
      "prev0": {
        "layer": {
          "class": "DenseSynapseLayerJBLAS",
          "id": "32bdbc21-af7b-447b-aa9f-63e500000002",
          "weights": "[ [ 0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,-0.0,0.0,0.0,0.0,0.0,-0.0 ],[ 0.0,-0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0 ],[ 0.0,0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0 ],... ]"
        },
        "prev0": {
          "target": "[a000a943-97f2-4a36-b242-09add87e1bc4, 887306db-ae10-48b2-b591-dcdfd234bc34]"
        }
      }
    }
  }
}
```



Code from [MindsEyeDemo.scala:81](../../src/test/scala/MindsEyeDemo.scala#L81) executed in 0.61 seconds: 
```java
    MNIST.trainingDataStream().iterator().asScala.toStream.map(labeledObj ⇒ {
      Array(labeledObj.data, toOutNDArray(toOut(labeledObj.label), 10))
    })
```

Returns: 

```
    Stream([Lcom.simiacryptus.util.ml.Tensor;@77602954, ?)
```



Code from [MindsEyeDemo.scala:87](../../src/test/scala/MindsEyeDemo.scala#L87) executed in 0.37 seconds: 
```java
    val previewTable = new TableOutput()
    data.take(10).map(testObj⇒{
      val row = new util.LinkedHashMap[String,AnyRef]()
      row.put("Input1 (as Image)",log.image(testObj(0).toGrayImage(), testObj(0).toString))
      row.put("Input2 (as String)",testObj(1).toString)
      row.put("Input1 (as String)",testObj(0).toString)
      row
    }).foreach(previewTable.putRow(_))
    previewTable
```

Returns: 

Input1 (as Image) | Input2 (as String) | Input1 (as String)
----------------- | ------------------ | ------------------
![aaa](mnist_simple.1.png)      | [ 0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 49.0 ],... ],... ]     
![bbb](mnist_simple.2.png)       | [ 1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
    

Code from [MindsEyeDemo.scala:99](../../src/test/scala/MindsEyeDemo.scala#L99) executed in 2.32 seconds: 
```java
    val trainingNetwork: DAGNetwork = new DAGNetwork
    trainingNetwork.add(model)
    trainingNetwork.addLossComponent(new EntropyLossLayer)
    val gradientTrainer: GradientDescentTrainer = new GradientDescentTrainer
    gradientTrainer.setNet(trainingNetwork)
    gradientTrainer.setData(data.toArray)
    new DynamicRateTrainer(gradientTrainer)
```

Returns: 

```
    com.simiacryptus.mindseye.training.DynamicRateTrainer@533b266e
```



Code from [MindsEyeDemo.scala:109](../../src/test/scala/MindsEyeDemo.scala#L109) executed in 64.63 seconds: 
```java
    val trainingContext = new TrainingContext
    trainingContext.terminalErr = 0.05
    trainer.step(trainingContext)
    val finalError = trainer.step(trainingContext).finalError
    System.out.println(s"Final Error = $finalError")
    model
```
Logging: 
```
    Final Error = 0.6458347431821405
    
```

Returns: 

```
    {
  "class": "DAGNetwork",
  "id": "32bdbc21-af7b-447b-aa9f-63e500000001",
  "root": {
    "layer": {
      "class": "SoftmaxActivationLayer",
      "id": "32bdbc21-af7b-447b-aa9f-63e500000004"
    },
    "prev0": {
      "layer": {
        "class": "BiasLayer",
        "id": "32bdbc21-af7b-447b-aa9f-63e500000003",
        "bias": "[-9.691137076162093E-7, 1.5343441499560129E-6, -3.4351232836016266E-7, -4.2958419199656817E-7, 4.3694753149026155E-7, 7.879961203723085E-7, -2.1095629513384617E-7, 6.943415185034496E-7, -1.3892904293655306E-6, -1.1117236797808516E-7]"
      },
      "prev0": {
        "layer": {
          "class": "DenseSynapseLayerJBLAS",
          "id": "32bdbc21-af7b-447b-aa9f-63e500000002",
          "weights": "[ [ 0.0,-1.9544089537859577E-6,2.4081468222902913E-4,-7.467189580268041E-5,-3.372374930421529E-5,-1.7693090839654424E-8,-2.8544836482069513E-5,-1.4611255556928882E-4,-7.370298206410553E-5,-2.4501336675086804E-6 ],[ 0.0,-1.7854039997544646E-6,-4.0632253626426973E-4,-1.771275673263517E-4,1.4274742386533035E-4,-7.786214936689184E-9,-1.9305982903006225E-5,-1.4633639125349873E-5,2.3873262799156691E-4,1.761227953522848E-5 ],[ 0.0,1.7399422048924862E-5,1.826439386718448E-4,-1.3863905076050287E-4,-1.3457297143304459E-6,-9.529725199936001E-9,2.0538898320410226E-4,9.494110724972415E-5,-2.756159866521557E-4,-6.56101767049222E-6 ],[ 0.0,-1.1920073688109767E-6,5.6013520037367925E-5,1.366525968080623E-4,2.7333096085158104E-5,-4.4929636511259474E-8,-6.536308793325674E-5,-3.791750864365895E-4,2.62688571893932E-4,4.59730277313497E-6 ],[ 0.0,-1.906700512588344E-6,2.5495416997500797E-4,-9.62490675533445E-5,2.5213833694692767E-5,-1.1172257171482292E-8,-9.953137215745755E-5,9.874910341700627E-5,-3.090446652436185E-4,-9.158686587795728E-6 ],[ 0.0,-1.5589604762666909E-6,6.895521113392533E-5,3.6490760317064996E-4,-7.925372838002431E-5,1.666737953209818E-7,-1.208285289919786E-4,1.8782707365971874E-4,-3.624921860900798E-5,-7.619736724251425E-6 ],[ 0.0,-7.491352014277197E-7,-1.6796278431030487E-4,1.3356153874610754E-4,-9.260768928243124E-5,-1.703098880673215E-8,1.4960620993065277E-4,-7.60969898010444E-5,2.0623530326702166E-4,-1.1488087231725785E-5 ],[ 0.0,-5.521946300213187E-7,2.646263936867399E-5,2.1560226306860386E-4,-1.0568799348220637E-4,-1.217329952118984E-8,-5.582777157542296E-5,5.5610422009522154E-5,-2.8266689230349584E-4,6.620271165047598E-6 ],... ]"
        },
        "prev0": {
          "target": "[a000a943-97f2-4a36-b242-09add87e1bc4, 887306db-ae10-48b2-b591-dcdfd234bc34]"
        }
      }
    }
  }
}
```



Code from [MindsEyeDemo.scala:118](../../src/test/scala/MindsEyeDemo.scala#L118) executed in 0.15 seconds: 
```java
    val validationTable = new TableOutput()
    MNIST.validationDataStream().iterator().asScala.toStream.take(10).map(testObj⇒{
      val row = new util.LinkedHashMap[String,AnyRef]()
      row.put("Input",log.image(testObj.data.toGrayImage(), testObj.label))
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i⇒result.get(i))
      row.put("Predicted Label", prediction.asInstanceOf[java.lang.Integer])
      row.put("Actual Label",testObj.label)
      row.put("Network Output",result)
      row
    }).foreach(validationTable.putRow(_))
    validationTable
```

Returns: 

Input | Predicted Label | Actual Label | Network Output
    ----- | --------------- | ------------ | --------------
    ![[7]](mnist_simple.11.png) |      7 | [7] | [ 0.004484284019064897,6.057606929870712E-4,0.0037922118299307853,0.0071761068838595695,0.007524921671197093,0.004438154494013742,0.0010948336413512125,0.926651987775195,0.004951678109927962,0.039280060882472774 ]
    ![[2]](mnist_simple.12.png) |      2 | [2] | [ 0.048484341544287816,0.017496341934984085,0.44056316790629557,0.134496516385504,0.0010244205769765651,0.10396518168503549,0.19856559179568292,8.243535114692958E-4,0.05295042063655996,0.0016296640232044213 ]
    ![[1]](mnist_simple.13.png) |      1 | [1] | [ 0.004427219214549754,0.8331631149741789,0.0350245000852411,0.027805100623172558,0.0073991887696221266,0.014837905720484008,0.017450761431247245,0.015283503876588715,0.03216203113612505,0.012446674168790459 ]
    ![[0]](mnist_simple.14.png) |      0 | [0] | [ 0.8958520076987592,4.5300746172330565E-5,0.007236224386689643,0.003964647800330971,0.0011515865818932933,0.031713058091584805,0.04267714538166494,0.009693644730627953,0.0028996617960210538,0.0047667227862559025 ]
    ![[4]](mnist_simple.15.png) |      4 | [4] | [ 0.025496055463796134,6.68816366673516E-4,0.06311360662012304,0.009796235372026368,0.6043655817680439,0.01775731075871813,0.04239013769467967,0.06508723072739193,0.03805956898505145,0.13326545624349584 ]
    ![[1]](mnist_simple.16.png) |      1 | [1] | [ 9.84392629136887E-4,0.9167327264522344,0.015116286332647652,0.01678243752197066,0.003081429018792888,0.0058947346820810475,0.003313709789705818,0.009678301179163847,0.020888657971275936,0.007527324422990731 ]
    ![[4]](mnist_simple.17.png) |      4 | [4] | [ 0.004246410830212852,0.003192088106480699,0.008819805747384944,0.051572030417953704,0.47780740362426843,0.08048279204082898,0.010862012197781922,0.1190087724322921,0.08836500873846051,0.15564367586433583 ]
    ![[9]](mnist_simple.18.png) |      9 | [9] | [ 0.004483006007621129,0.01835507698561296,0.01884705970411072,0.03800234567026569,0.20269617648334767,0.10375718673334657,0.06369092200802114,0.04102612005727076,0.05840731543206532,0.45073479091833807 ]
    ![[5]](mnist_simple.19.png) |      2 | [5] | [ 0.09056230118245955,0.014787199049732705,0.2673129275597934,0.0065315699291693,0.15119182929262717,0.09950446089093694,0.23676208498261692,0.012763087899409584,0.05624915993677287,0.06433537927648145 ]
    ![[9]](mnist_simple.20.png) |      9 | [9] | [ 0.006148269317304755,0.0020233954733313566,0.0024104652204443625,0.002823092971747029,0.13766120906288495,0.019931772405163074,0.007470660649621921,0.3266379391599814,0.019395589215658756,0.4754976065238625 ]
    



Code from [MindsEyeDemo.scala:134](../../src/test/scala/MindsEyeDemo.scala#L134) executed in 0.75 seconds: 
```java
    MNIST.validationDataStream().iterator().asScala.toStream.map(testObj⇒{
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i⇒result.get(i))
      val actual: Int = toOut(testObj.label)
      actual → prediction
    }).groupBy(_._1).mapValues(_.groupBy(_._2).mapValues(_.size))
```

Returns: 

```
    Map(0 -> Map(0 -> 937, 5 -> 9, 6 -> 17, 2 -> 5, 7 -> 1, 3 -> 4, 8 -> 7), 5 -> Map(0 -> 25, 5 -> 651, 1 -> 20, 6 -> 26, 9 -> 18, 2 -> 8, 7 -> 11, 3 -> 72, 8 -> 34, 4 -> 27), 1 -> Map(5 -> 4, 1 -> 1087, 6 -> 4, 2 -> 12, 3 -> 4, 8 -> 23, 4 -> 1), 6 -> Map(0 -> 20, 5 -> 21, 1 -> 6, 6 -> 873, 2 -> 18, 3 -> 2, 8 -> 5, 4 -> 13), 9 -> Map(0 -> 12, 5 -> 12, 1 -> 15, 6 -> 2, 9 -> 837, 2 -> 12, 7 -> 36, 3 -> 13, 8 -> 9, 4 -> 61), 2 -> Map(0 -> 17, 1 -> 22, 6 -> 29, 9 -> 7, 2 -> 850, 7 -> 21, 3 -> 25, 8 -> 40, 4 -> 21), 7 -> Map(0 -> 5, 1 -> 41, 6 -> 3, 9 -> 41, 2 -> 25, 7 -> 889, 3 -> 1, 8 -> 9, 4 -> 14), 3 -> Map(0 -> 6, 5 -> 39, 1 -> 4, 6 -> 8, 9 -> 14, 2 -> 26, 7 -> 23, 3 -> 868, 8 -> 21, 4 -> 1), 8 -> Map(0 -> 10, 5 -> 35, 1 -> 21, 6 -> 20, 9 -> 27, 2 -> 18, 7 -> 15, 3 -> 52, 8 -> 765, 4 -> 11), 4 -> Map(0 -> 3, 5 -> 1, 1 -> 10, 6 -> 20, 9 -> 72, 2 -> 5, 7 -> 2, 8 -> 9, 4 -> 860))
```



Actual \ Predicted | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9
--- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
 **0** | 937 | 0 | 5 | 4 | 0 | 9 | 17 | 1 | 7 | 0
 **1** | 0 | 1087 | 12 | 4 | 1 | 4 | 4 | 0 | 23 | 0
 **2** | 17 | 22 | 850 | 25 | 21 | 0 | 29 | 21 | 40 | 7
 **3** | 6 | 4 | 26 | 868 | 1 | 39 | 8 | 23 | 21 | 14
 **4** | 3 | 10 | 5 | 0 | 860 | 1 | 20 | 2 | 9 | 72
 **5** | 25 | 20 | 8 | 72 | 27 | 651 | 26 | 11 | 34 | 18
 **6** | 20 | 6 | 18 | 2 | 13 | 21 | 873 | 0 | 5 | 0
 **7** | 5 | 41 | 25 | 1 | 14 | 0 | 3 | 889 | 9 | 41
 **8** | 10 | 21 | 18 | 52 | 11 | 35 | 20 | 15 | 765 | 27
 **9** | 12 | 15 | 12 | 13 | 61 | 12 | 2 | 36 | 9 | 837
 
Code from [MindsEyeDemo.scala:149](../../src/test/scala/MindsEyeDemo.scala#L149) executed in 0.03 seconds: 
```java
    (0 to 9).map(actual⇒{
      actual → (categorizationMatrix(actual)(actual) * 100.0 / categorizationMatrix(actual).values.sum)
    }).toMap
```

Returns: 

```
    Map(0 -> 95.61224489795919, 5 -> 72.98206278026906, 1 -> 95.77092511013215, 6 -> 91.12734864300626, 9 -> 82.95341922695738, 2 -> 82.36434108527132, 7 -> 86.47859922178988, 3 -> 85.94059405940594, 8 -> 78.54209445585215, 4 -> 87.57637474541751)
```



Code from [MindsEyeDemo.scala:154](../../src/test/scala/MindsEyeDemo.scala#L154) executed in 0.02 seconds: 
```java
    (0 to 9).map(actual⇒{
      categorizationMatrix(actual)(actual)
    }).sum.toDouble * 100.0 / categorizationMatrix.values.flatMap(_.values).sum
```

Returns: 

```
    86.17
```



Code from [MindsEyeDemo.scala:161](../../src/test/scala/MindsEyeDemo.scala#L161) executed in 0.53 seconds: 
```java
    val validationTable = new TableOutput()
    MNIST.validationDataStream().iterator().asScala.toStream.filterNot(testObj⇒{
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i⇒result.get(i))
      val actual = toOut(testObj.label)
      prediction == actual
    }).take(10).map(testObj⇒{
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i⇒result.get(i))
      val row = new util.LinkedHashMap[String,AnyRef]()
      row.put("Input",log.image(testObj.data.toGrayImage(), testObj.label))
      row.put("Predicted Label", prediction.asInstanceOf[java.lang.Integer])
      row.put("Actual Label", testObj.label)
      row.put("Network Output", result)
      row
    }).foreach(validationTable.putRow(_))
    validationTable
```

Returns: 

Input | Predicted Label | Actual Label | Network Output
    ----- | --------------- | ------------ | --------------
    ![[5]](mnist_simple.21.png) |      2 | [5] | [ 0.09056230118245955,0.014787199049732705,0.2673129275597934,0.0065315699291693,0.15119182929262717,0.09950446089093694,0.23676208498261692,0.012763087899409584,0.05624915993677287,0.06433537927648145 ]
    ![[4]](mnist_simple.22.png) |      0 | [4] | [ 0.4148747720105899,7.913578596064973E-4,0.08890153347950469,0.0013373689365864495,0.09385934016419441,0.05051352710880573,0.3094430340815473,0.005466586865112143,0.020176118040101047,0.014636361453951922 ]
    ![[2]](mnist_simple.23.png) |      3 | [2] | [ 0.07172274987873727,0.06515380977614324,0.22677285266107847,0.3233282431035789,0.0012635221180677567,0.09092280977369059,0.09314401187444306,0.0047112089201615266,0.11877703274298805,0.004203759151110965 ]
    ![[1]](mnist_simple.24.png) |      3 | [1] | [ 0.004045967893471885,0.11046920603143692,0.08353025633409161,0.25891744623903523,0.049129528959530225,0.15408078786026835,0.07662409639711829,0.05998591859881813,0.10446368661222279,0.0987531050740066 ]
    ![[5]](mnist_simple.25.png) |      3 | [5] | [ 0.09776831284538111,0.010653617276786398,0.03787054204139494,0.2827740080954282,0.054472654088240355,0.276667790210292,0.044032991078416246,0.020949290874327998,0.141467029858047,0.0333437636316857 ]
    ![[6]](mnist_simple.26.png) |      2 | [6] | [ 0.045096610492122276,0.014205876368676174,0.4716167551136895,0.03356220729944688,0.10142587936272873,0.015410768781576054,0.21943902424873626,0.01976150897517717,0.05658129328175383,0.02290007607609307 ]
    ![[3]](mnist_simple.27.png) |      2 | [3] | [ 0.011736753670873788,0.0331474271820529,0.4342715973862084,0.21088183176924133,0.0423788472393804,0.049122382406520455,0.028612933080543235,0.015122036768005206,0.09823565902147488,0.07649053147569937 ]
    ![[4]](mnist_simple.28.png) |      9 | [4] | [ 0.007973662427793658,0.018267431944815025,0.022489259286931577,0.1412139401844421,0.18295252374678958,0.1546652763714061,0.05881304256386538,0.036753407495948846,0.13968318679009273,0.23718826918791494 ]
    ![[6]](mnist_simple.29.png) |      2 | [6] | [ 0.1169467927865575,0.03078091656420452,0.2702414310201862,0.05969321779490994,0.12503405126562434,0.025885762627798712,0.21261724574459595,0.09395357763606066,0.037107355079938315,0.027739649480123772 ]
    ![[9]](mnist_simple.30.png) |      8 | [9] | [ 0.0045026746337838855,0.13823381071488375,0.0712648267731778,0.050083087768150875,0.012482617412804176,0.03273853876221319,0.008781765360479667,0.2060296625123947,0.30691192632269204,0.16897108973941985 ]
    



