In this demo we train a simple neural network against the MNIST handwritten digit dataset

## Data
First, we load the training dataset: 

Code from [MindsEyeDemo.scala:105](../../src/test/scala/MindsEyeDemo.scala#L105) executed in 0.66 seconds: 
```java
    MNIST.trainingDataStream().iterator().asScala.toStream.map(labeledObj ⇒ {
      Array(labeledObj.data, toOutNDArray(toOut(labeledObj.label), 10))
    })
```

Returns: 

```
    Stream([Lcom.simiacryptus.util.ml.Tensor;@4961f6af, ?)
```



And preview a few rows: 

Code from [MindsEyeDemo.scala:111](../../src/test/scala/MindsEyeDemo.scala#L111) executed in 0.26 seconds: 
```java
    TableOutput.create(data.take(10).map(testObj ⇒ Map[String,AnyRef](
      "Input1 (as Image)" → log.image(testObj(0).toGrayImage(), testObj(0).toString),
      "Input2 (as String)" → testObj(1).toString,
      "Input1 (as String)" → testObj(0).toString
    ).asJava):_*)
```

Returns: 

Input1 (as Image) | Input2 (as String) | Input1 (as String)
----------------- | ------------------ | ------------------
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 49.0 ],... ],... ]](mnist_simple.1.png)      | [ 0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 49.0 ],... ],... ]     
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.2.png)       | [ 1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 62.0 ],[ 126.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 81.0 ],[ 163.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.3.png) | [ 0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 62.0 ],[ 126.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 81.0 ],[ 163.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.4.png)       | [ 0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.5.png)       | [ 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.6.png)       | [ 0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.7.png)       | [ 0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.8.png)       | [ 0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.9.png)       | [ 0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      
![[ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]](mnist_simple.10.png)      | [ 0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0 ] | [ [ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],[ [ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],[ 0.0 ],... ],... ]      




## Model
Here we define the logic network that we are about to train: 

Code from [MindsEyeDemo.scala:121](../../src/test/scala/MindsEyeDemo.scala#L121) executed in 0.58 seconds: 
```java
    var model: PipelineNetwork = new PipelineNetwork
    model.add(new DenseSynapseLayerJBLAS(Tensor.dim(inputSize: _*), outputSize).setWeights(new ToDoubleFunction[Coordinate] {
      override def applyAsDouble(value: Coordinate): Double = Util.R.get.nextGaussian * 0.0
    }))
    model.add(new BiasLayer(outputSize: _*))
    model.add(new SoftmaxActivationLayer)
    model
```

Returns: 

```
    {
      "class": "PipelineNetwork",
      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000001",
      "nodes": [
        {
          "id": {
            "class": "DenseSynapseLayerJBLAS",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
            "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
          },
          "prev0": {
            "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
          }
        },
        {
          "id": {
            "class": "BiasLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
            "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
          },
          "prev0": {
            "id": {
              "class": "DenseSynapseLayerJBLAS",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
              "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
            },
            "prev0": {
              "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
            }
          }
        },
        {
          "id": {
            "class": "SoftmaxActivationLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
          },
          "prev0": {
            "id": {
              "class": "BiasLayer",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
              "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
            },
            "prev0": {
              "id": {
                "class": "DenseSynapseLayerJBLAS",
                "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
              },
              "prev0": {
                "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
              }
            }
          }
        }
      ],
      "root": {
        "id": {
          "class": "SoftmaxActivationLayer",
          "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
        },
        "prev0": {
          "id": {
            "class": "BiasLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
            "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
          },
          "prev0": {
            "id": {
              "class": "DenseSynapseLayerJBLAS",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
              "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
            },
            "prev0": {
              "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
            }
          }
        }
      }
    }
```



We can visualize this network as a graph: 

Code from [MindsEyeDemo.scala:523](../../src/test/scala/MindsEyeDemo.scala#L523) executed in 5.86 seconds: 
```java
    Graphviz.fromGraph(toGraph(network)).width(width).render(Format.PNG).toImage
```

Returns: 

![Result](mnist_simple.11.png)



We encapsulate our model network within a supervisory network that applies a loss function: 

Code from [MindsEyeDemo.scala:133](../../src/test/scala/MindsEyeDemo.scala#L133) executed in 0.00 seconds: 
```java
    new SupervisedNetwork(model, new EntropyLossLayer)
```

Returns: 

```
    {
      "class": "SupervisedNetwork",
      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000006",
      "nodes": [
        {
          "id": {
            "class": "PipelineNetwork",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000001",
            "nodes": [
              {
                "id": {
                  "class": "DenseSynapseLayerJBLAS",
                  "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                  "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                },
                "prev0": {
                  "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                }
              },
              {
                "id": {
                  "class": "BiasLayer",
                  "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
                  "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
                },
                "prev0": {
                  "id": {
                    "class": "DenseSynapseLayerJBLAS",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                    "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                  },
                  "prev0": {
                    "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                  }
                }
              },
              {
                "id": {
                  "class": "SoftmaxActivationLayer",
                  "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
                },
                "prev0": {
                  "id": {
                    "class": "BiasLayer",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
                    "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
                  },
                  "prev0": {
                    "id": {
                      "class": "DenseSynapseLayerJBLAS",
                      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                      "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                    },
                    "prev0": {
                      "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                    }
                  }
                }
              }
            ],
            "root": {
              "id": {
                "class": "SoftmaxActivationLayer",
                "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
              },
              "prev0": {
                "id": {
                  "class": "BiasLayer",
                  "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
                  "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
                },
                "prev0": {
                  "id": {
                    "class": "DenseSynapseLayerJBLAS",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                    "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                  },
                  "prev0": {
                    "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                  }
                }
              }
            }
          },
          "prev0": {
            "target": "[5e5f4233-8ca8-4926-bd5c-8ec6ae694177, 27b9c22d-17be-42d7-a038-f216cab5779d]"
          }
        },
        {
          "id": {
            "class": "EntropyLossLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000005"
          },
          "prev0": {
            "id": {
              "class": "PipelineNetwork",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000001",
              "nodes": [
                {
                  "id": {
                    "class": "DenseSynapseLayerJBLAS",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                    "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                  },
                  "prev0": {
                    "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                  }
                },
                {
                  "id": {
                    "class": "BiasLayer",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
                    "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
                  },
                  "prev0": {
                    "id": {
                      "class": "DenseSynapseLayerJBLAS",
                      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                      "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                    },
                    "prev0": {
                      "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                    }
                  }
                },
                {
                  "id": {
                    "class": "SoftmaxActivationLayer",
                    "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
                  },
                  "prev0": {
                    "id": {
                      "class": "BiasLayer",
                      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
                      "bias": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]"
                    },
                    "prev0": {
                      "id": {
                        "class": "DenseSynapseLayerJBLAS",
                        "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                        "weights": "[ [ 0.0,0.0,0.0,0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,-0.0,-0.0,-0.0,0.0,0.0,0.0,-0.0,0.0 ],[ -0.0,0.0,-0.0,-0.0,0.0,0.0,-0.0,-0.0,0.0,-0.0 ],[ -0.0,0.0,0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0 ],[ -0.0,-0.0,0.0,0.0,-0.0,-0.0,-0.0,-0.0,0.0,0.0 ],[ -0.0,0.0,0.0,-0.0,0.0,0.0,0.0,-0.0,0.0,-0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,0.0 ],[ 0.0,0.0,0.0,0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0 ],... ]"
                      },
                      "prev0": {
                        "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
                      }
                    }
                  }
                }
              ],
              "root": {
                "id": {
                  "class": "SoftmaxActivationLayer",
           ... and 1339 more bytes
```



With a the following component graph: 

Code from [MindsEyeDemo.scala:523](../../src/test/scala/MindsEyeDemo.scala#L523) executed in 0.34 seconds: 
```java
    Graphviz.fromGraph(toGraph(network)).width(width).render(Format.PNG).toImage
```

Returns: 

![Result](mnist_simple.12.png)



Note that this visualization does not expand DAGNetworks recursively

## Training
We train using a standard iterative L-BFGS strategy: 

Code from [MindsEyeDemo.scala:142](../../src/test/scala/MindsEyeDemo.scala#L142) executed in 2.30 seconds: 
```java
    val gradientTrainer: LbfgsTrainer = new LbfgsTrainer
    gradientTrainer.setNet(trainingNetwork)
    gradientTrainer.setData(data.toArray)
    new IterativeTrainer(gradientTrainer)
```

Returns: 

```
    com.simiacryptus.mindseye.training.IterativeTrainer@4c168660
```



Code from [MindsEyeDemo.scala:148](../../src/test/scala/MindsEyeDemo.scala#L148) executed in 63.59 seconds: 
```java
    val trainingContext = new TrainingContext
    trainingContext.terminalErr = 0.0
    trainingContext.setTimeout(5, TimeUnit.SECONDS)
    trainer.step(trainingContext)
    val finalError = trainer.step(trainingContext).finalError
    System.out.println(s"Final Error = $finalError")
```
Logging: 
```
    Final Error = 0.9087820265031541
    
```

Returns: 

```
    ()
```



After training, we have the following parameterized model: 

Code from [MindsEyeDemo.scala:157](../../src/test/scala/MindsEyeDemo.scala#L157) executed in 0.22 seconds: 
```java
    model.toString
```

Returns: 

```
    {
      "class": "PipelineNetwork",
      "id": "5c4a4a38-73ac-488b-b1a1-b55a00000001",
      "nodes": [
        {
          "id": {
            "class": "DenseSynapseLayerJBLAS",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
            "weights": "[ [ 0.0,-3.1022522462237134E-6,3.7632522554481953E-4,-1.8795022302147053E-4,-6.676929062493447E-5,-3.103691401666131E-8,-6.0837183151251205E-5,-3.485650084504966E-4,-6.416559411504299E-5,-4.957083754846663E-6 ],[ 0.0,-2.501637831475566E-6,-8.257003545781173E-4,-3.3950025370295693E-4,2.8607208502843775E-4,-2.1047984157628357E-8,-7.152719598770135E-5,9.398782046559716E-5,6.203639220843318E-4,2.8480364309694013E-5 ],[ 0.0,2.944068996749356E-5,3.853742633191091E-4,-9.350614126009947E-5,-3.3021265451710215E-5,-2.1061349494513436E-8,4.2591657633241504E-4,9.46054233117112E-5,-6.54345932809017E-4,-9.498509030947147E-6 ],[ 0.0,-3.094896347832365E-6,1.5677960847598069E-4,2.7469419277048384E-4,5.292341258730925E-5,-5.854868903828354E-8,-1.9918396389524912E-4,-9.683752967147497E-4,5.946705722955049E-4,7.80921488521231E-6 ],[ 0.0,-3.2677758109298787E-6,6.37284455005768E-4,-1.0169714037278338E-4,8.500202421284199E-5,-2.105573703363779E-8,-2.1064648712118217E-4,2.9118219216144254E-4,-6.445119028809297E-4,-2.0100515855819826E-5 ],[ 0.0,-3.0680479634463666E-6,2.511268358711547E-4,7.628337759140564E-4,-2.1881820346905556E-4,2.416512148126503E-7,-2.4814954179888687E-4,3.1384030234809043E-4,-1.4300905083465808E-4,-1.4076786307568384E-5 ],[ 0.0,-1.3989664816591442E-6,-4.7566716528455876E-4,1.1213785880338889E-4,-1.3501362427860208E-4,-2.1423015672136245E-8,3.9495607238973203E-4,-3.586346773871437E-5,2.471984437340812E-4,-1.5534931987785307E-5 ],[ 0.0,-9.100730257372176E-7,1.1982314625195604E-4,5.1007374422094E-4,-1.8586043279935385E-4,-2.107098969726356E-8,-1.4885595226791967E-4,1.9652590061243111E-4,-5.6469221578228E-4,4.557547417759918E-6 ],... ]"
          },
          "prev0": {
            "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
          }
        },
        {
          "id": {
            "class": "BiasLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
            "bias": "[-3.229319661144056E-6, 2.2278537072257387E-6, 3.382605273863766E-7, -5.265189117686653E-7, 1.2956119591866532E-6, 1.4269829716665957E-6, 7.111561930643398E-8, 1.1616435925348632E-6, -3.0379803535492515E-6, 2.723505491539802E-7]"
          },
          "prev0": {
            "id": {
              "class": "DenseSynapseLayerJBLAS",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
              "weights": "[ [ 0.0,-3.1022522462237134E-6,3.7632522554481953E-4,-1.8795022302147053E-4,-6.676929062493447E-5,-3.103691401666131E-8,-6.0837183151251205E-5,-3.485650084504966E-4,-6.416559411504299E-5,-4.957083754846663E-6 ],[ 0.0,-2.501637831475566E-6,-8.257003545781173E-4,-3.3950025370295693E-4,2.8607208502843775E-4,-2.1047984157628357E-8,-7.152719598770135E-5,9.398782046559716E-5,6.203639220843318E-4,2.8480364309694013E-5 ],[ 0.0,2.944068996749356E-5,3.853742633191091E-4,-9.350614126009947E-5,-3.3021265451710215E-5,-2.1061349494513436E-8,4.2591657633241504E-4,9.46054233117112E-5,-6.54345932809017E-4,-9.498509030947147E-6 ],[ 0.0,-3.094896347832365E-6,1.5677960847598069E-4,2.7469419277048384E-4,5.292341258730925E-5,-5.854868903828354E-8,-1.9918396389524912E-4,-9.683752967147497E-4,5.946705722955049E-4,7.80921488521231E-6 ],[ 0.0,-3.2677758109298787E-6,6.37284455005768E-4,-1.0169714037278338E-4,8.500202421284199E-5,-2.105573703363779E-8,-2.1064648712118217E-4,2.9118219216144254E-4,-6.445119028809297E-4,-2.0100515855819826E-5 ],[ 0.0,-3.0680479634463666E-6,2.511268358711547E-4,7.628337759140564E-4,-2.1881820346905556E-4,2.416512148126503E-7,-2.4814954179888687E-4,3.1384030234809043E-4,-1.4300905083465808E-4,-1.4076786307568384E-5 ],[ 0.0,-1.3989664816591442E-6,-4.7566716528455876E-4,1.1213785880338889E-4,-1.3501362427860208E-4,-2.1423015672136245E-8,3.9495607238973203E-4,-3.586346773871437E-5,2.471984437340812E-4,-1.5534931987785307E-5 ],[ 0.0,-9.100730257372176E-7,1.1982314625195604E-4,5.1007374422094E-4,-1.8586043279935385E-4,-2.107098969726356E-8,-1.4885595226791967E-4,1.9652590061243111E-4,-5.6469221578228E-4,4.557547417759918E-6 ],... ]"
            },
            "prev0": {
              "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
            }
          }
        },
        {
          "id": {
            "class": "SoftmaxActivationLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
          },
          "prev0": {
            "id": {
              "class": "BiasLayer",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
              "bias": "[-3.229319661144056E-6, 2.2278537072257387E-6, 3.382605273863766E-7, -5.265189117686653E-7, 1.2956119591866532E-6, 1.4269829716665957E-6, 7.111561930643398E-8, 1.1616435925348632E-6, -3.0379803535492515E-6, 2.723505491539802E-7]"
            },
            "prev0": {
              "id": {
                "class": "DenseSynapseLayerJBLAS",
                "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
                "weights": "[ [ 0.0,-3.1022522462237134E-6,3.7632522554481953E-4,-1.8795022302147053E-4,-6.676929062493447E-5,-3.103691401666131E-8,-6.0837183151251205E-5,-3.485650084504966E-4,-6.416559411504299E-5,-4.957083754846663E-6 ],[ 0.0,-2.501637831475566E-6,-8.257003545781173E-4,-3.3950025370295693E-4,2.8607208502843775E-4,-2.1047984157628357E-8,-7.152719598770135E-5,9.398782046559716E-5,6.203639220843318E-4,2.8480364309694013E-5 ],[ 0.0,2.944068996749356E-5,3.853742633191091E-4,-9.350614126009947E-5,-3.3021265451710215E-5,-2.1061349494513436E-8,4.2591657633241504E-4,9.46054233117112E-5,-6.54345932809017E-4,-9.498509030947147E-6 ],[ 0.0,-3.094896347832365E-6,1.5677960847598069E-4,2.7469419277048384E-4,5.292341258730925E-5,-5.854868903828354E-8,-1.9918396389524912E-4,-9.683752967147497E-4,5.946705722955049E-4,7.80921488521231E-6 ],[ 0.0,-3.2677758109298787E-6,6.37284455005768E-4,-1.0169714037278338E-4,8.500202421284199E-5,-2.105573703363779E-8,-2.1064648712118217E-4,2.9118219216144254E-4,-6.445119028809297E-4,-2.0100515855819826E-5 ],[ 0.0,-3.0680479634463666E-6,2.511268358711547E-4,7.628337759140564E-4,-2.1881820346905556E-4,2.416512148126503E-7,-2.4814954179888687E-4,3.1384030234809043E-4,-1.4300905083465808E-4,-1.4076786307568384E-5 ],[ 0.0,-1.3989664816591442E-6,-4.7566716528455876E-4,1.1213785880338889E-4,-1.3501362427860208E-4,-2.1423015672136245E-8,3.9495607238973203E-4,-3.586346773871437E-5,2.471984437340812E-4,-1.5534931987785307E-5 ],[ 0.0,-9.100730257372176E-7,1.1982314625195604E-4,5.1007374422094E-4,-1.8586043279935385E-4,-2.107098969726356E-8,-1.4885595226791967E-4,1.9652590061243111E-4,-5.6469221578228E-4,4.557547417759918E-6 ],... ]"
              },
              "prev0": {
                "target": "[fbd3680d-47cc-402a-a41a-78a749260b3e]"
              }
            }
          }
        }
      ],
      "root": {
        "id": {
          "class": "SoftmaxActivationLayer",
          "id": "5c4a4a38-73ac-488b-b1a1-b55a00000004"
        },
        "prev0": {
          "id": {
            "class": "BiasLayer",
            "id": "5c4a4a38-73ac-488b-b1a1-b55a00000003",
            "bias": "[-3.229319661144056E-6, 2.2278537072257387E-6, 3.382605273863766E-7, -5.265189117686653E-7, 1.2956119591866532E-6, 1.4269829716665957E-6, 7.111561930643398E-8, 1.1616435925348632E-6, -3.0379803535492515E-6, 2.723505491539802E-7]"
          },
          "prev0": {
            "id": {
              "class": "DenseSynapseLayerJBLAS",
              "id": "5c4a4a38-73ac-488b-b1a1-b55a00000002",
              "weights": "[ [ 0.0,-3.1022522462237134E-6,3.7632522554481953E-4,-1.8795022302147053E-4,-6.676929062493447E-5,-3.103691401666131E-8,-6.0837183151251205E-5,-3.485650084504966E-4,-6.416559411504299E-5,-4.957083754846663E-6 ],[ 0.0,-2.501637831475566E-6,-8.257003545781173E-4,-3.3950025370295693E-4,2.8607208502843775E-4,-2.1047984157628357E-8,-7.152719598770135E-5,9.398782046559716E-5,6.203639220843318E-4,2.8480364309694013E-5 ],[ 0.0,2.944068996749356E-5,3.853742633191091E-4,-9.350614126009947E-5,-3.3021265451710215E-5,-2.10613494... and 1288 more bytes
```



A summary of the training timeline: 

Code from [MindsEyeDemo.scala:486](../../src/test/scala/MindsEyeDemo.scala#L486) executed in 0.00 seconds: 
```java
    val step = Math.max(Math.pow(10,Math.ceil(Math.log(history.size()) / Math.log(10))-2), 1).toInt
    TableOutput.create(history.asScala.filter(0==_.getIteration%step).map(state ⇒
      Map[String, AnyRef](
        "iteration" → state.getIteration.toInt.asInstanceOf[Integer],
        "time" → state.getEvaluationTime.toDouble.asInstanceOf[lang.Double],
        "fitness" → state.getFitness.toDouble.asInstanceOf[lang.Double]
      ).asJava
    ): _*)
```

Returns: 

iteration | time | fitness
--------- | ---- | -------
     0 | 56.0831 | 1.4641
     1 | 7.4909 | 0.9088




Code from [MindsEyeDemo.scala:496](../../src/test/scala/MindsEyeDemo.scala#L496) executed in 0.28 seconds: 
```java
    val plot: PlotCanvas = ScatterPlot.plot(history.asScala.map(item ⇒ Array[Double](
      item.getIteration, Math.log(item.getFitness)
    )).toArray: _*)
    plot.setTitle("Convergence Plot")
    plot.setAxisLabels("Iteration", "log(Fitness)")
    plot.setSize(600, 400)
    plot
```

Returns: 

![Result](mnist_simple.13.png)



## Validation
Here we examine a sample of validation rows, randomly selected: 

Code from [MindsEyeDemo.scala:165](../../src/test/scala/MindsEyeDemo.scala#L165) executed in 0.14 seconds: 
```java
    TableOutput.create(MNIST.validationDataStream().iterator().asScala.toStream.take(10).map(testObj ⇒ {
      val result = model.eval(testObj.data).data.head
      Map[String, AnyRef](
        "Input" → log.image(testObj.data.toGrayImage(), testObj.label),
        "Predicted Label" → (0 to 9).maxBy(i ⇒ result.get(i)).asInstanceOf[java.lang.Integer],
        "Actual Label" → testObj.label,
        "Network Output" → result
      ).asJava
    }): _*)
```

Returns: 

Input | Predicted Label | Actual Label | Network Output
----- | --------------- | ------------ | --------------
![[7]](mnist_simple.14.png) |      7 | [7] | [ 7.021869733160281E-7,3.118509407875413E-8,1.4147813265911576E-5,1.1168785222453401E-5,1.2866813529314842E-4,1.554959664577603E-5,9.569508809366471E-7,0.9983058854441059,1.5047798390365918E-6,0.0015213851226793822 ]
![[2]](mnist_simple.15.png) |      2 | [2] | [ 1.7858741115243704E-4,8.602305129432396E-5,0.8309215233591492,0.045767510760507606,1.2143898345579719E-6,0.01945480045097392,0.10330249206108616,2.20109790999339E-7,2.856745362008429E-4,1.953870010277181E-6 ]
![[1]](mnist_simple.16.png) |      1 | [1] | [ 2.6972734675870273E-6,0.9960905475182131,0.0023015893614558936,6.531052776145768E-4,3.983533192564009E-5,2.3530082050525545E-4,2.6753020402067056E-4,1.1644902084943398E-4,1.8523591351026086E-4,1.0770927843716563E-4 ]
![[0]](mnist_simple.17.png) |      0 | [0] | [ 0.7546973854941532,3.079979366609938E-10,0.005449192321994082,2.3521032290581026E-4,8.533642766143756E-5,0.02370775246402982,0.21510632407805697,4.980479656779601E-4,2.531518126266086E-6,2.1821909939637066E-4 ]
![[4]](mnist_simple.18.png) |      4 | [4] | [ 4.7723116894162234E-5,1.1916481248112057E-8,0.008327326024502847,4.694040492090059E-5,0.9728849284897444,2.3980866483337614E-4,0.0025616353459451367,0.0027018169224510497,1.0194916019722483E-4,0.013087859954029939 ]
![[1]](mnist_simple.19.png) |      1 | [1] | [ 4.446760992447289E-8,0.9991965324024839,4.642334640592192E-4,1.8819654478175428E-4,6.189366162645999E-6,3.648544491975548E-5,7.817978448816757E-6,3.6109406987988005E-5,3.124223453477379E-5,3.314869001142796E-5 ]
![[4]](mnist_simple.20.png) |      4 | [4] | [ 1.786277226559401E-6,1.5081782147324984E-6,5.477591215195032E-4,0.004440264689416514,0.8573112352010241,0.012992809893680029,2.6417730391187927E-4,0.045963205558042404,8.877331533140736E-4,0.07758952062364992 ]
![[9]](mnist_simple.21.png) |      9 | [9] | [ 2.6744131338373923E-6,1.0851176662698313E-4,0.0026991775992101894,0.004172996502920763,0.3963766174171107,0.0462229178224838,0.0335172832261323,0.004857680257799755,7.946673899198882E-4,0.5112474736046617 ]
![[5]](mnist_simple.22.png) |      2 | [5] | [ 8.27668280773012E-4,2.32727772228548E-5,0.6519466830629597,6.0569893268785094E-5,0.11192841606766939,0.02040950143491952,0.2081014704318121,1.6252241833966422E-4,2.1135397688977752E-4,0.0063285416561453724 ]
![[9]](mnist_simple.23.png) |      7 | [9] | [ 8.651986747603771E-7,4.806779095851476E-7,6.685785543950672E-5,5.882387899988152E-6,0.18187749396422465,0.0010323406101885044,2.3501878986411962E-4,0.42984911096402517,7.974524648018565E-6,0.3869239750271257 ]




Validation rows that are mispredicted are also sampled: 

Code from [MindsEyeDemo.scala:177](../../src/test/scala/MindsEyeDemo.scala#L177) executed in 0.72 seconds: 
```java
    TableOutput.create(MNIST.validationDataStream().iterator().asScala.toStream.filterNot(testObj ⇒ {
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i ⇒ result.get(i))
      val actual = toOut(testObj.label)
      prediction == actual
    }).take(10).map(testObj ⇒ {
      val result = model.eval(testObj.data).data.head
      Map[String, AnyRef](
        "Input" → log.image(testObj.data.toGrayImage(), testObj.label),
        "Predicted Label" → (0 to 9).maxBy(i ⇒ result.get(i)).asInstanceOf[java.lang.Integer],
        "Actual Label" → testObj.label,
        "Network Output" → result
      ).asJava
    }): _*)
```

Returns: 

Input | Predicted Label | Actual Label | Network Output
----- | --------------- | ------------ | --------------
![[5]](mnist_simple.24.png) |      2 | [5] | [ 8.27668280773012E-4,2.32727772228548E-5,0.6519466830629597,6.0569893268785094E-5,0.11192841606766939,0.02040950143491952,0.2081014704318121,1.6252241833966422E-4,2.1135397688977752E-4,0.0063285416561453724 ]
![[9]](mnist_simple.25.png) |      7 | [9] | [ 8.651986747603771E-7,4.806779095851476E-7,6.685785543950672E-5,5.882387899988152E-6,0.18187749396422465,0.0010323406101885044,2.3501878986411962E-4,0.42984911096402517,7.974524648018565E-6,0.3869239750271257 ]
![[6]](mnist_simple.26.png) |      2 | [6] | [ 0.032207639590951936,8.10559288238943E-5,0.585013357319531,0.013519385403066736,0.04297508608769559,0.00784438803077379,0.3147593734740981,1.7493033951000955E-4,0.0020097127095260593,0.0014150711160228055 ]
![[5]](mnist_simple.27.png) |      3 | [5] | [ 0.012202582954663118,1.8762145701660238E-5,0.018866303708929,0.7011291025592318,0.0010320756429550266,0.25664241784582503,0.0027353603121448374,3.0149044020700503E-4,0.006762491468839029,3.094129215033965E-4 ]
![[9]](mnist_simple.28.png) |      4 | [9] | [ 9.077788987170864E-6,9.903546600290006E-9,0.003638172901949025,6.937916346115888E-5,0.6724183955947325,2.491723057678376E-4,0.0010428135098587811,0.025560715525276275,1.0630804427224451E-4,0.2969059552621486 ]
![[9]](mnist_simple.29.png) |      7 | [9] | [ 3.6331989805462754E-7,2.0845876198561115E-5,5.183886048610403E-5,0.0010693378865738424,0.027880924729242272,0.011686180828999677,2.513426781663363E-5,0.6134723251678772,4.433587127612351E-5,0.34574871319163164 ]
![[4]](mnist_simple.30.png) |      6 | [4] | [ 0.29293183518853055,8.04705493665671E-8,0.041943753613251526,2.9977156682676516E-6,0.029248755745273566,0.0021984159968036743,0.6332610296905853,2.8287837820459628E-5,6.533554668026354E-5,3.195081948372298E-4 ]
![[2]](mnist_simple.31.png) |      3 | [2] | [ 0.0033727811254824366,0.0035049480550758435,0.43351528440151305,0.4713748523668446,5.06112815876996E-6,0.038609528699961385,0.043889653803585976,1.9616677045626343E-5,0.005674463830684192,3.3809911648136255E-5 ]
![[1]](mnist_simple.32.png) |      3 | [1] | [ 6.038883910463127E-6,0.009396577836768883,0.11780491795886862,0.3834107042029438,0.03166172014615859,0.2656609574242065,0.08443633348404157,0.018385427103350394,0.006938923824667194,0.08229839913508372 ]
![[5]](mnist_simple.33.png) |      3 | [5] | [ 0.01723609076744468,6.637888132613139E-5,0.01174653633423515,0.6615375321999132,0.01121750460265536,0.26806382306613025,0.01104105285710802,8.473497579533394E-4,0.014790065140128598,0.003453666393105144 ]




To summarize the accuracy of the model, we calculate several summaries: 

The (mis)categorization matrix displays a count matrix for every actual/predicted category: 

Code from [MindsEyeDemo.scala:195](../../src/test/scala/MindsEyeDemo.scala#L195) executed in 0.63 seconds: 
```java
    MNIST.validationDataStream().iterator().asScala.toStream.map(testObj ⇒ {
      val result = model.eval(testObj.data).data.head
      val prediction: Int = (0 to 9).maxBy(i ⇒ result.get(i))
      val actual: Int = toOut(testObj.label)
      actual → prediction
    }).groupBy(_._1).mapValues(_.groupBy(_._2).mapValues(_.size))
```

Returns: 

```
    Map(0 -> Map(0 -> 782, 5 -> 82, 6 -> 85, 2 -> 26, 7 -> 1, 3 -> 4), 5 -> Map(0 -> 5, 5 -> 634, 1 -> 8, 6 -> 38, 9 -> 9, 2 -> 54, 7 -> 9, 3 -> 98, 4 -> 37), 1 -> Map(5 -> 19, 1 -> 1031, 6 -> 9, 2 -> 66, 3 -> 9, 4 -> 1), 6 -> Map(0 -> 6, 5 -> 20, 1 -> 6, 6 -> 873, 2 -> 39, 3 -> 2, 4 -> 12), 9 -> Map(0 -> 2, 5 -> 24, 1 -> 10, 6 -> 7, 9 -> 628, 2 -> 24, 7 -> 46, 3 -> 14, 4 -> 254), 2 -> Map(0 -> 5, 5 -> 2, 1 -> 6, 6 -> 29, 9 -> 1, 2 -> 932, 7 -> 13, 3 -> 22, 8 -> 2, 4 -> 20), 7 -> Map(0 -> 3, 1 -> 28, 6 -> 4, 9 -> 35, 2 -> 62, 7 -> 876, 4 -> 20), 3 -> Map(0 -> 2, 5 -> 53, 1 -> 1, 6 -> 12, 9 -> 16, 2 -> 81, 7 -> 13, 3 -> 829, 4 -> 3), 8 -> Map(0 -> 2, 5 -> 316, 1 -> 20, 6 -> 31, 9 -> 70, 2 -> 289, 7 -> 20, 3 -> 150, 8 -> 34, 4 -> 42), 4 -> Map(5 -> 2, 1 -> 7, 6 -> 28, 9 -> 36, 2 -> 11, 7 -> 1, 4 -> 897))
```



Actual \ Predicted | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9
--- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---
 **0** | 782 | 0 | 26 | 4 | 0 | 82 | 85 | 1 | 0 | 0
 **1** | 0 | 1031 | 66 | 9 | 1 | 19 | 9 | 0 | 0 | 0
 **2** | 5 | 6 | 932 | 22 | 20 | 2 | 29 | 13 | 2 | 1
 **3** | 2 | 1 | 81 | 829 | 3 | 53 | 12 | 13 | 0 | 16
 **4** | 0 | 7 | 11 | 0 | 897 | 2 | 28 | 1 | 0 | 36
 **5** | 5 | 8 | 54 | 98 | 37 | 634 | 38 | 9 | 0 | 9
 **6** | 6 | 6 | 39 | 2 | 12 | 20 | 873 | 0 | 0 | 0
 **7** | 3 | 28 | 62 | 0 | 20 | 0 | 4 | 876 | 0 | 35
 **8** | 2 | 20 | 289 | 150 | 42 | 316 | 31 | 20 | 34 | 70
 **9** | 2 | 10 | 24 | 14 | 254 | 24 | 7 | 46 | 0 | 628

The accuracy, summarized per category: 

Code from [MindsEyeDemo.scala:212](../../src/test/scala/MindsEyeDemo.scala#L212) executed in 0.10 seconds: 
```java
    (0 to 9).map(actual ⇒ {
      actual → (categorizationMatrix.getOrElse(actual, Map.empty).getOrElse(actual, 0) * 100.0 / categorizationMatrix.getOrElse(actual,Map.empty).values.sum)
    }).toMap
```

Returns: 

```
    Map(0 -> 79.79591836734694, 5 -> 71.0762331838565, 1 -> 90.83700440528635, 6 -> 91.12734864300626, 9 -> 62.239841427155596, 2 -> 90.31007751937985, 7 -> 85.21400778210116, 3 -> 82.07920792079207, 8 -> 3.490759753593429, 4 -> 91.34419551934828)
```



The accuracy, summarized over the entire validation set: 

Code from [MindsEyeDemo.scala:218](../../src/test/scala/MindsEyeDemo.scala#L218) executed in 0.04 seconds: 
```java
    (0 to 9).map(actual ⇒ {
      categorizationMatrix.getOrElse(actual, Map.empty).getOrElse(actual, 0)
    }).sum.toDouble * 100.0 / categorizationMatrix.values.flatMap(_.values).sum
```

Returns: 

```
    75.16
```



